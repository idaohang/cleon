<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CLEON: sys/sys_usb.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLEON
   &#160;<span id="projectnumber">Version 1</span>
   </div>
   <div id="projectbrief">Cloud-Offloaded GPS Receiver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sys__usb_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sys_usb.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>USB related functions.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h__dep__incl.png" border="0" usemap="#sys_2sys__usb_8hdep" alt=""/></div>
<map name="sys_2sys__usb_8hdep" id="sys_2sys__usb_8hdep">
<area shape="rect" id="node3" href="sys__define_8h.html" title="System definitions for CLEON." alt="" coords="1499,80,1619,107"/><area shape="rect" id="node5" href="app__log_8c.html" title="Logging CLEON data." alt="" coords="5,155,107,181"/><area shape="rect" id="node7" href="app__usb_8c.html" title="Communication via USB." alt="" coords="132,155,239,181"/><area shape="rect" id="node9" href="diskio_8c.html" title="fs/FatFs/diskio.c" alt="" coords="263,155,381,181"/><area shape="rect" id="node11" href="fs__init_8c.html" title="Initializing file system." alt="" coords="406,155,487,181"/><area shape="rect" id="node13" href="hal__adc_8c.html" title="ADC configuration." alt="" coords="512,155,611,181"/><area shape="rect" id="node15" href="hal__dma_8c.html" title="DMA configuration." alt="" coords="635,155,737,181"/><area shape="rect" id="node17" href="hal__flash_8c.html" title="FLASH configuration." alt="" coords="762,155,867,181"/><area shape="rect" id="node19" href="hal__gpio_8c.html" title="GPIO configuration." alt="" coords="891,155,993,181"/><area shape="rect" id="node21" href="hal__init_8c.html" title="Initializing HAL." alt="" coords="1018,155,1112,181"/><area shape="rect" id="node23" href="hal__pmm_8c.html" title="PMM configuration." alt="" coords="1137,155,1244,181"/><area shape="rect" id="node25" href="hal__rtc_8c.html" title="RTC configuration." alt="" coords="1268,155,1361,181"/><area shape="rect" id="node27" href="hal__spi_8c.html" title="SPI configuration." alt="" coords="1386,155,1480,181"/><area shape="rect" id="node29" href="hal__timer_8c.html" title="timer configuration" alt="" coords="1505,155,1612,181"/><area shape="rect" id="node31" href="hal__uart_8c.html" title="UART configuration." alt="" coords="1637,155,1736,181"/><area shape="rect" id="node33" href="hal__ucs_8c.html" title="Universal clock system configuration." alt="" coords="1761,155,1860,181"/><area shape="rect" id="node35" href="hal__wdt_8c.html" title="Watchdog timer configuration." alt="" coords="1884,155,1983,181"/><area shape="rect" id="node37" href="main_8c.html" title="Main entry for the CLEO sensor board firmware." alt="" coords="2007,155,2068,181"/><area shape="rect" id="node39" href="sys__flash_8c.html" title="FLASH related functions." alt="" coords="2093,155,2205,181"/><area shape="rect" id="node41" href="sys__gps_8c.html" title="GPS related functions." alt="" coords="2231,155,2337,181"/><area shape="rect" id="node43" href="sys__init_8c.html" title="Initializing the system." alt="" coords="2362,155,2464,181"/><area shape="rect" id="node45" href="sys__mcu_8c.html" title="MCU related functions." alt="" coords="2489,155,2599,181"/><area shape="rect" id="node47" href="sys__mmc_8c.html" title="Micro SD card related functions." alt="" coords="2624,155,2739,181"/><area shape="rect" id="node49" href="sys__power_8c.html" title="Power related functions." alt="" coords="2763,155,2883,181"/><area shape="rect" id="node51" href="sys__sensors_8c.html" title="Sensors related functions." alt="" coords="2907,155,3039,181"/><area shape="rect" id="node53" href="sys__usb_8c.html" title="USB related functions." alt="" coords="3064,155,3171,181"/></map>
</div>
</div>
<p><a href="sys__usb_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structusb__frame__s.html">usb_frame_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionusb__frame__u.html">usb_frame_u</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae8f4b71e449e2ba88c044a6dbd372207"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#ae8f4b71e449e2ba88c044a6dbd372207">USB_FRAME_HEADER</a>&#160;&#160;&#160;0x55</td></tr>
<tr class="separator:ae8f4b71e449e2ba88c044a6dbd372207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930d0d5588900b8eec123d7d4a263703"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a930d0d5588900b8eec123d7d4a263703">USB_FRAME_FOOTER</a>&#160;&#160;&#160;0xAA</td></tr>
<tr class="separator:a930d0d5588900b8eec123d7d4a263703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b207eefa4052ad3b39ec0d22c542e73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a7b207eefa4052ad3b39ec0d22c542e73">USB_FRAME_DATA_FIELD_LENGTH</a>&#160;&#160;&#160;29</td></tr>
<tr class="separator:a7b207eefa4052ad3b39ec0d22c542e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc8bbf503f7f46a2665da2e7cc83d3d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#aabc8bbf503f7f46a2665da2e7cc83d3d">USB_FRAME_COMMAND_AND_DATA_FIELD_LENGTH</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:aabc8bbf503f7f46a2665da2e7cc83d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab625a22d4a7772da48074bdea09024ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#ab625a22d4a7772da48074bdea09024ed">USB_FRAME_LENGTH</a>&#160;&#160;&#160;36</td></tr>
<tr class="separator:ab625a22d4a7772da48074bdea09024ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb77a972faf7c895a1c49988f60083bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#adb77a972faf7c895a1c49988f60083bd">USB_FRAME_COMMAND_CONNECT</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:adb77a972faf7c895a1c49988f60083bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fd0a7144018af69a59ce94b2469a35"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a79fd0a7144018af69a59ce94b2469a35">USB_FRAME_COMMAND_UPDATE_RTC_TIME</a>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:a79fd0a7144018af69a59ce94b2469a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3a892cb6eb506625eb28234c48674e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#ace3a892cb6eb506625eb28234c48674e">USB_FRAME_COMMAND_UPDATE_TIME_TICK</a>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:ace3a892cb6eb506625eb28234c48674e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d5a0d65102c809e6e538fc822499494"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a3d5a0d65102c809e6e538fc822499494">USB_FRAME_COMMAND_UPDATE_SAMPLE_COUNT</a>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:a3d5a0d65102c809e6e538fc822499494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f929804c203d991728b6c13caa5b76d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a7f929804c203d991728b6c13caa5b76d">USB_FRAME_COMMAND_UPDATE_SAMPLE_GAP</a>&#160;&#160;&#160;0x05</td></tr>
<tr class="separator:a7f929804c203d991728b6c13caa5b76d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4adedbf93842ed931883de76b463fd40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a4adedbf93842ed931883de76b463fd40">USB_FRAME_COMMAND_UPDATE_CHUNK_COUNT</a>&#160;&#160;&#160;0x06</td></tr>
<tr class="separator:a4adedbf93842ed931883de76b463fd40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae52d5846f76f1665a538486b4119ea4e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#ae52d5846f76f1665a538486b4119ea4e">USB_FRAME_COMMAND_UPDATE_CHUNK_GAP</a>&#160;&#160;&#160;0x07</td></tr>
<tr class="separator:ae52d5846f76f1665a538486b4119ea4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a445dbf21a2fd44357332b39126996d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a6a445dbf21a2fd44357332b39126996d">USB_FRAME_COMMAND_ACK</a>&#160;&#160;&#160;0xFF</td></tr>
<tr class="separator:a6a445dbf21a2fd44357332b39126996d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dcf19ca7c5b0eb5733d86464e34d714"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a7dcf19ca7c5b0eb5733d86464e34d714">SYS_USB_IsUSBConnected</a>()&#160;&#160;&#160;((<a class="el" href="cleon__conf_8h.html#ac973d9edce9ffb0827a9f7f3c0aecf67">USB_STATUS_PORT</a>(IN) &amp; <a class="el" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="el" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>)) &gt;&gt; <a class="el" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>)</td></tr>
<tr class="separator:a7dcf19ca7c5b0eb5733d86464e34d714"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af8813b5d2b2deefc562494227822a938"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#af8813b5d2b2deefc562494227822a938">SYS_USB_Init</a> (void)</td></tr>
<tr class="memdesc:af8813b5d2b2deefc562494227822a938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing USB.  <a href="#af8813b5d2b2deefc562494227822a938"></a><br/></td></tr>
<tr class="separator:af8813b5d2b2deefc562494227822a938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44b75cba45b6c944312deccd963ba033"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a44b75cba45b6c944312deccd963ba033">SYS_USB_SendACK</a> (unsigned char ucCommand)</td></tr>
<tr class="memdesc:a44b75cba45b6c944312deccd963ba033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sending USB frame ACK.  <a href="#a44b75cba45b6c944312deccd963ba033"></a><br/></td></tr>
<tr class="separator:a44b75cba45b6c944312deccd963ba033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e6191d3fa2f23698f5b9d816c597e3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a5e6191d3fa2f23698f5b9d816c597e3c">SYS_USB_Printf</a> (char *format,...)</td></tr>
<tr class="memdesc:a5e6191d3fa2f23698f5b9d816c597e3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mimic the standard 'printf' with USB as output device.  <a href="#a5e6191d3fa2f23698f5b9d816c597e3c"></a><br/></td></tr>
<tr class="separator:a5e6191d3fa2f23698f5b9d816c597e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51c770de14905e59f7ef907a7a3db6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#ad51c770de14905e59f7ef907a7a3db6b">SYS_USB_ReceiveFrame</a> (unsigned char ucData)</td></tr>
<tr class="memdesc:ad51c770de14905e59f7ef907a7a3db6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receiving a bayte and test whether correct frame has been received.  <a href="#ad51c770de14905e59f7ef907a7a3db6b"></a><br/></td></tr>
<tr class="separator:ad51c770de14905e59f7ef907a7a3db6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a069c08a273a8d79c93bd53a0bf672e4b"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a069c08a273a8d79c93bd53a0bf672e4b">SYS_USB_BuildCRC</a> (<a class="el" href="unionusb__frame__u.html">usb_frame_u</a> *uniUSBFrame)</td></tr>
<tr class="memdesc:a069c08a273a8d79c93bd53a0bf672e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Building CRC out of USB frame.  <a href="#a069c08a273a8d79c93bd53a0bf672e4b"></a><br/></td></tr>
<tr class="separator:a069c08a273a8d79c93bd53a0bf672e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147a398f76677cac67a63d26e487e631"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sys__usb_8h.html#a147a398f76677cac67a63d26e487e631">SYS_USB_TransmitSingleByte</a> (unsigned char ucData)</td></tr>
<tr class="memdesc:a147a398f76677cac67a63d26e487e631"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit a byte vis USB.  <a href="#a147a398f76677cac67a63d26e487e631"></a><br/></td></tr>
<tr class="separator:a147a398f76677cac67a63d26e487e631"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>USB related functions. </p>

<p>Definition in file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a7dcf19ca7c5b0eb5733d86464e34d714"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SYS_USB_IsUSBConnected</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="cleon__conf_8h.html#ac973d9edce9ffb0827a9f7f3c0aecf67">USB_STATUS_PORT</a>(IN) &amp; <a class="el" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="el" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>)) &gt;&gt; <a class="el" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00042">42</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6a445dbf21a2fd44357332b39126996d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_ACK&#160;&#160;&#160;0xFF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00025">25</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="aabc8bbf503f7f46a2665da2e7cc83d3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_AND_DATA_FIELD_LENGTH&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00015">15</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="adb77a972faf7c895a1c49988f60083bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_CONNECT&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00018">18</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4adedbf93842ed931883de76b463fd40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_UPDATE_CHUNK_COUNT&#160;&#160;&#160;0x06</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00023">23</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae52d5846f76f1665a538486b4119ea4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_UPDATE_CHUNK_GAP&#160;&#160;&#160;0x07</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00024">24</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a79fd0a7144018af69a59ce94b2469a35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_UPDATE_RTC_TIME&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00019">19</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3d5a0d65102c809e6e538fc822499494"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_UPDATE_SAMPLE_COUNT&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00021">21</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7f929804c203d991728b6c13caa5b76d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_UPDATE_SAMPLE_GAP&#160;&#160;&#160;0x05</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00022">22</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="ace3a892cb6eb506625eb28234c48674e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_COMMAND_UPDATE_TIME_TICK&#160;&#160;&#160;0x03</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00020">20</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7b207eefa4052ad3b39ec0d22c542e73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_DATA_FIELD_LENGTH&#160;&#160;&#160;29</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00014">14</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a930d0d5588900b8eec123d7d4a263703"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_FOOTER&#160;&#160;&#160;0xAA</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00012">12</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae8f4b71e449e2ba88c044a6dbd372207"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_HEADER&#160;&#160;&#160;0x55</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00011">11</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab625a22d4a7772da48074bdea09024ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_FRAME_LENGTH&#160;&#160;&#160;36</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sys__usb_8h_source.html#l00016">16</a> of file <a class="el" href="sys__usb_8h_source.html">sys_usb.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a069c08a273a8d79c93bd53a0bf672e4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char SYS_USB_BuildCRC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="unionusb__frame__u.html">usb_frame_u</a> *&#160;</td>
          <td class="paramname"><em>uniUSBFrame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Building CRC out of USB frame. </p>
<dl class="section return"><dt>Returns</dt><dd>ucCheckOctet - generated CRC</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sys__usb_8c_source.html#l00215">215</a> of file <a class="el" href="sys__usb_8c_source.html">sys_usb.c</a>.</p>
<div class="fragment"><div class="line">{       </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ucCheckOctet = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 3 ; i &lt; (<a class="code" href="sys__usb_8h.html#ab625a22d4a7772da48074bdea09024ed">USB_FRAME_LENGTH</a> - 3) ; i++ ){</div>
<div class="line">                <span class="keywordflow">if</span>( i == 0 ){</div>
<div class="line">                        ucCheckOctet = (*uniUSBFrame).ucSingleByte[i];</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (i &gt;= 1)</div>
<div class="line">                {</div>
<div class="line">                        ucCheckOctet ^= (*uniUSBFrame).ucSingleByte[i];</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">    ucCheckOctet = ~ucCheckOctet;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> ucCheckOctet;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_a069c08a273a8d79c93bd53a0bf672e4b_icgraph.png" border="0" usemap="#sys__usb_8h_a069c08a273a8d79c93bd53a0bf672e4b_icgraph" alt=""/></div>
<map name="sys__usb_8h_a069c08a273a8d79c93bd53a0bf672e4b_icgraph" id="sys__usb_8h_a069c08a273a8d79c93bd53a0bf672e4b_icgraph">
<area shape="rect" id="node3" href="sys__usb_8h.html#a44b75cba45b6c944312deccd963ba033" title="Sending USB frame ACK." alt="" coords="213,5,360,32"/><area shape="rect" id="node9" href="sys__usb_8h.html#ad51c770de14905e59f7ef907a7a3db6b" title="Receiving a bayte and test whether correct frame has been received." alt="" coords="201,56,373,83"/><area shape="rect" id="node5" href="app__usb_8h.html#afd3e69fbaca3347223f9a409ae53b4f6" title="Processing USB frame." alt="" coords="422,5,642,32"/><area shape="rect" id="node7" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="main" alt="" coords="691,5,741,32"/><area shape="rect" id="node11" href="hal__uart_8c.html#a2ab57f8a3e6e32703bd1ea58f958e4ee" title="USCI_A1_VECTOR_ISR" alt="" coords="451,56,613,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af8813b5d2b2deefc562494227822a938"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SYS_USB_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing USB. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sys__usb_8c_source.html#l00037">37</a> of file <a class="el" href="sys__usb_8c_source.html">sys_usb.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="cleon__conf_8h.html#a4dcf0c4645a516a9227149cd966be3b1">USB_PORT</a>(<span class="keywordtype">SEL</span>) |= <a class="code" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="code" href="cleon__conf_8h.html#ad2783215bfef70d924d606766ead001b">USB_TXD_PIN</a>);</div>
<div class="line">    <a class="code" href="cleon__conf_8h.html#a4dcf0c4645a516a9227149cd966be3b1">USB_PORT</a>(<span class="keywordtype">SEL</span>) |= <a class="code" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="code" href="cleon__conf_8h.html#a4b2573133aa13d5375d837353f8df67c">USB_RXD_PIN</a>);</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="cleon__conf_8h.html#ac973d9edce9ffb0827a9f7f3c0aecf67">USB_STATUS_PORT</a>(<a class="code" href="struct_d_i_r.html">DIR</a>) &amp;= ~<a class="code" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="code" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>);</div>
<div class="line">    <a class="code" href="cleon__conf_8h.html#ac973d9edce9ffb0827a9f7f3c0aecf67">USB_STATUS_PORT</a>(IES) &amp;= ~<a class="code" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="code" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>);</div>
<div class="line">    <a class="code" href="cleon__conf_8h.html#ac973d9edce9ffb0827a9f7f3c0aecf67">USB_STATUS_PORT</a>(IE)  |=  <a class="code" href="hal__define_8h.html#a0188837b5508334447b93ad7b944a0e9">BV</a>(<a class="code" href="cleon__conf_8h.html#aa79febaf08e785c7106760a15353909c">USB_STATUS_PIN</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="sys__usb_8h.html#a7dcf19ca7c5b0eb5733d86464e34d714">SYS_USB_IsUSBConnected</a>() == <a class="code" href="sys__define_8h.html#af175ab2b4aba9e9f5cc3b3bc42a1f92b">_TRUE_</a>){</div>
<div class="line">        <a class="code" href="app__usb_8c.html#a777ecebfb3620f282194efa8c4f25828">bFLAG_USBConnected</a> = <a class="code" href="sys__define_8h.html#af175ab2b4aba9e9f5cc3b3bc42a1f92b">_TRUE_</a>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_af8813b5d2b2deefc562494227822a938_icgraph.png" border="0" usemap="#sys__usb_8h_af8813b5d2b2deefc562494227822a938_icgraph" alt=""/></div>
<map name="sys__usb_8h_af8813b5d2b2deefc562494227822a938_icgraph" id="sys__usb_8h_af8813b5d2b2deefc562494227822a938_icgraph">
<area shape="rect" id="node3" href="sys__init_8h.html#ae7266b09907efcfb4bc5df00c544715c" title="Initializing CLEON." alt="" coords="161,5,234,32"/><area shape="rect" id="node5" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="main" alt="" coords="283,5,333,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5e6191d3fa2f23698f5b9d816c597e3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SYS_USB_Printf </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mimic the standard 'printf' with USB as output device. </p>
<pre class="fragment">      - Sending a byte (stream) to USB
</pre><dl class="section return"><dt>Returns</dt><dd>index - number of bytes sent</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>- a byte to be sent to USB </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sys__usb_8c_source.html#l00091">91</a> of file <a class="el" href="sys__usb_8c_source.html">sys_usb.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="comment">// Maximum length of data is 255</span></div>
<div class="line">    <span class="keywordtype">char</span>            buff[250];</div>
<div class="line">    <span class="keywordtype">int</span>             index = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   data = 0;</div>
<div class="line">    va_list         argptr;         <span class="comment">// Argument list</span></div>
<div class="line"></div>
<div class="line">    buff[0] = 0x00;</div>
<div class="line">    va_start( argptr,format);       <span class="comment">// Initializing the function</span></div>
<div class="line">    vsprintf(buff,format,argptr );  <span class="comment">// Copying buffer</span></div>
<div class="line">    va_end( argptr );               <span class="comment">// Finalizing the function</span></div>
<div class="line"></div>
<div class="line">    data = buff[index++];               <span class="comment">// Loading data</span></div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span>(data != 0x00){</div>
<div class="line">        <span class="comment">//USCI_A1 TX buffer ready?</span></div>
<div class="line">        <span class="keywordflow">while</span> (!(UCA1IFG&amp;UCTXIFG));     <span class="comment">// USCI_A1 TX buffer ready?</span></div>
<div class="line">        UCA1TXBUF = data;               </div>
<div class="line">        data = buff[index++];</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span>(index);</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_a5e6191d3fa2f23698f5b9d816c597e3c_icgraph.png" border="0" usemap="#sys__usb_8h_a5e6191d3fa2f23698f5b9d816c597e3c_icgraph" alt=""/></div>
<map name="sys__usb_8h_a5e6191d3fa2f23698f5b9d816c597e3c_icgraph" id="sys__usb_8h_a5e6191d3fa2f23698f5b9d816c597e3c_icgraph">
<area shape="rect" id="node3" href="hal__init_8h.html#a62fc6fe0ace20baedb48d662c349225b" title="Initializing hardware." alt="" coords="275,5,346,32"/><area shape="rect" id="node11" href="sys__sensors_8h.html#ab77918dcbb562698c1658cf7d60621e6" title="Read sensor value of S1087 (PAR)" alt="" coords="210,56,411,83"/><area shape="rect" id="node16" href="sys__sensors_8h.html#a490dd722bffde9c01dc3c3299b27a790" title="Read sensor value of S1087&#45;01 (TSR)" alt="" coords="203,107,418,133"/><area shape="rect" id="node19" href="sys__sensors_8h.html#ae97605a716834deb766758fd269559bc" title="Read SHT11 temperature." alt="" coords="173,157,448,184"/><area shape="rect" id="node22" href="sys__sensors_8h.html#aef8a5f70ef9c92c4c2d60438f88e6e97" title="Read SHT11 humidity." alt="" coords="183,208,438,235"/><area shape="rect" id="node5" href="sys__mcu_8h.html#a8dfc2685c2dd0f59270135852e204987" title="Initializing microcontroller." alt="" coords="496,12,605,39"/><area shape="rect" id="node7" href="sys__init_8h.html#ae7266b09907efcfb4bc5df00c544715c" title="Initializing CLEON." alt="" coords="654,37,727,64"/><area shape="rect" id="node9" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="main" alt="" coords="776,69,827,96"/><area shape="rect" id="node13" href="app__log_8h.html#af0aa7ce17d347ccd13683acc6952403c" title="Collect CLEON data sample(s)" alt="" coords="512,107,589,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad51c770de14905e59f7ef907a7a3db6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SYS_USB_ReceiveFrame </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ucData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receiving a bayte and test whether correct frame has been received. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ucData</td><td>- recived single byte from USB </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sys__usb_8c_source.html#l00138">138</a> of file <a class="el" href="sys__usb_8c_source.html">sys_usb.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="app__usb_8c.html#a667cdd4b45a7195d810cae5973c6609c">bFLAG_USBFrameReceived</a> == <a class="code" href="sys__define_8h.html#afc54047c03b10696eb5f82429be9858d">_CLEAR_</a>){</div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>){</div>
<div class="line">            <span class="keywordflow">case</span> 0: <span class="keywordflow">case</span> 1:</div>
<div class="line">                <span class="keywordflow">if</span>(ucData == <a class="code" href="sys__usb_8h.html#ae8f4b71e449e2ba88c044a6dbd372207">USB_FRAME_HEADER</a>){</div>
<div class="line">                    <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a823e5e5a9417d00a6688391c568baa50">ucHeader</a>[<a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>] = ucData;</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>++;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> = 0;</div>
<div class="line">                    <span class="comment">// request retransmission</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                <span class="keywordflow">if</span>((<a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a823e5e5a9417d00a6688391c568baa50">ucHeader</a>[0] == <a class="code" href="sys__usb_8h.html#ae8f4b71e449e2ba88c044a6dbd372207">USB_FRAME_HEADER</a>)&amp;&amp;(<a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a823e5e5a9417d00a6688391c568baa50">ucHeader</a>[1] == <a class="code" href="sys__usb_8h.html#ae8f4b71e449e2ba88c044a6dbd372207">USB_FRAME_HEADER</a>) &amp;&amp;</div>
<div class="line">                   (ucData &gt; 0) &amp;&amp; (ucData &lt; <a class="code" href="sys__usb_8h.html#aabc8bbf503f7f46a2665da2e7cc83d3d">USB_FRAME_COMMAND_AND_DATA_FIELD_LENGTH</a>)){</div>
<div class="line">                    <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a38e9aa847ea845793637eb45328fd4f1">ucLength</a> = ucData;</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>++;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> = 0;</div>
<div class="line">                    <span class="comment">// request retransmission</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 3:</div>
<div class="line">                <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#ac349f5955a545a6793ea82d56c89734e">ucCommand</a> = ucData;</div>
<div class="line">                <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>++;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 4:  <span class="keywordflow">case</span> 5:  <span class="keywordflow">case</span> 6:  <span class="keywordflow">case</span> 7:  <span class="keywordflow">case</span> 8:  <span class="keywordflow">case</span> 9:  <span class="keywordflow">case</span> 10: <span class="keywordflow">case</span> 11: <span class="keywordflow">case</span> 12: <span class="keywordflow">case</span> 13: </div>
<div class="line">            <span class="keywordflow">case</span> 14: <span class="keywordflow">case</span> 15: <span class="keywordflow">case</span> 16: <span class="keywordflow">case</span> 17: <span class="keywordflow">case</span> 18: <span class="keywordflow">case</span> 19: <span class="keywordflow">case</span> 20: <span class="keywordflow">case</span> 21: <span class="keywordflow">case</span> 22: <span class="keywordflow">case</span> 23: </div>
<div class="line">            <span class="keywordflow">case</span> 24: <span class="keywordflow">case</span> 25: <span class="keywordflow">case</span> 26: <span class="keywordflow">case</span> 27: <span class="keywordflow">case</span> 28: <span class="keywordflow">case</span> 29: <span class="keywordflow">case</span> 30: <span class="keywordflow">case</span> 31: <span class="keywordflow">case</span> 32:</div>
<div class="line">                <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a86281c31a94d55727860820cd4452f15">ucData</a>[<a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> - 4] = ucData;</div>
<div class="line">                <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>++;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 33:</div>
<div class="line">                <span class="keywordflow">if</span>(ucData == <a class="code" href="sys__usb_8c.html#a069c08a273a8d79c93bd53a0bf672e4b" title="Building CRC out of USB frame.">SYS_USB_BuildCRC</a>(&amp;<a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>)){</div>
<div class="line">                    <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#aa706143c2c40d45ef0f5789007aa99e8">ucCRC</a> = ucData;</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>++;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> = 0;</div>
<div class="line">                    <span class="comment">// request retransmission</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 34:</div>
<div class="line">                <span class="keywordflow">if</span>(ucData == <a class="code" href="sys__usb_8h.html#a930d0d5588900b8eec123d7d4a263703">USB_FRAME_FOOTER</a>){</div>
<div class="line">                    <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a6d232f5c4ea1b0eb71e562758bfedc08">ucFooter</a>[<a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> - 34] = ucData;</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a>++;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> = 0;</div>
<div class="line">                    <span class="comment">// request retransmission</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 35:</div>
<div class="line">                <span class="keywordflow">if</span>(ucData == <a class="code" href="sys__usb_8h.html#a930d0d5588900b8eec123d7d4a263703">USB_FRAME_FOOTER</a>){</div>
<div class="line">                    <a class="code" href="app__usb_8c.html#a412f5667c5b22ddf52e7837098dd9992">uniUSBRecvFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a6d232f5c4ea1b0eb71e562758bfedc08">ucFooter</a>[<a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> - 34] = ucData;</div>
<div class="line">                    <a class="code" href="app__usb_8c.html#a667cdd4b45a7195d810cae5973c6609c">bFLAG_USBFrameReceived</a> = <a class="code" href="sys__define_8h.html#ad2fa27be1ebf441ffb13210fe689cbf6">_SET_</a>;</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> = 0;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                    <a class="code" href="sys__usb_8c.html#aae1470279bae447b9c1cf70cefec3cc9">ucUSBFrameByteCount</a> = 0;</div>
<div class="line">                    <span class="comment">// request retransmission</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="comment">// request retransmission</span></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_cgraph.png" border="0" usemap="#sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_cgraph" alt=""/></div>
<map name="sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_cgraph" id="sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_cgraph">
<area shape="rect" id="node3" href="sys__usb_8c.html#a069c08a273a8d79c93bd53a0bf672e4b" title="Building CRC out of USB frame." alt="" coords="227,5,373,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_icgraph.png" border="0" usemap="#sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_icgraph" alt=""/></div>
<map name="sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_icgraph" id="sys__usb_8h_ad51c770de14905e59f7ef907a7a3db6b_icgraph">
<area shape="rect" id="node3" href="hal__uart_8c.html#a2ab57f8a3e6e32703bd1ea58f958e4ee" title="USCI_A1_VECTOR_ISR" alt="" coords="227,5,389,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a44b75cba45b6c944312deccd963ba033"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SYS_USB_SendACK </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ucCommand</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sending USB frame ACK. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ucCommand</td><td>- command to be sent </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sys__usb_8c_source.html#l00059">59</a> of file <a class="el" href="sys__usb_8c_source.html">sys_usb.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    memset(&amp;<a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>, 0 , <span class="keyword">sizeof</span>(<a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>));</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a823e5e5a9417d00a6688391c568baa50">ucHeader</a>[0] = <a class="code" href="sys__usb_8h.html#ae8f4b71e449e2ba88c044a6dbd372207">USB_FRAME_HEADER</a>;</div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a823e5e5a9417d00a6688391c568baa50">ucHeader</a>[1] = <a class="code" href="sys__usb_8h.html#ae8f4b71e449e2ba88c044a6dbd372207">USB_FRAME_HEADER</a>;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a38e9aa847ea845793637eb45328fd4f1">ucLength</a> = 0x02;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#ac349f5955a545a6793ea82d56c89734e">ucCommand</a> = <a class="code" href="sys__usb_8h.html#a6a445dbf21a2fd44357332b39126996d">USB_FRAME_COMMAND_ACK</a>;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a86281c31a94d55727860820cd4452f15">ucData</a>[0] = ucCommand;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#aa706143c2c40d45ef0f5789007aa99e8">ucCRC</a> = <a class="code" href="sys__usb_8c.html#a069c08a273a8d79c93bd53a0bf672e4b" title="Building CRC out of USB frame.">SYS_USB_BuildCRC</a>(&amp;<a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>);</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a6d232f5c4ea1b0eb71e562758bfedc08">ucFooter</a>[0] = <a class="code" href="sys__usb_8h.html#a930d0d5588900b8eec123d7d4a263703">USB_FRAME_FOOTER</a>;</div>
<div class="line">    <a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a98a8cf16731f53767cb4b64f3decc885">stUSBFrame</a>.<a class="code" href="structusb__frame__s.html#a6d232f5c4ea1b0eb71e562758bfedc08">ucFooter</a>[1] = <a class="code" href="sys__usb_8h.html#a930d0d5588900b8eec123d7d4a263703">USB_FRAME_FOOTER</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="sys__usb_8h.html#ab625a22d4a7772da48074bdea09024ed">USB_FRAME_LENGTH</a> ; i++){</div>
<div class="line">        <a class="code" href="sys__usb_8c.html#a147a398f76677cac67a63d26e487e631" title="Transmit a byte vis USB.">SYS_USB_TransmitSingleByte</a>(<a class="code" href="sys__usb_8c.html#ad39da5cfbfed9a9e4daa3bf9171d2ab0">uniUSBSendFrame</a>.<a class="code" href="unionusb__frame__u.html#a2c9aa597cd15d34bf8e1c00138af913f">ucSingleByte</a>[i]);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_a44b75cba45b6c944312deccd963ba033_cgraph.png" border="0" usemap="#sys__usb_8h_a44b75cba45b6c944312deccd963ba033_cgraph" alt=""/></div>
<map name="sys__usb_8h_a44b75cba45b6c944312deccd963ba033_cgraph" id="sys__usb_8h_a44b75cba45b6c944312deccd963ba033_cgraph">
<area shape="rect" id="node3" href="sys__usb_8c.html#a069c08a273a8d79c93bd53a0bf672e4b" title="Building CRC out of USB frame." alt="" coords="228,5,375,32"/><area shape="rect" id="node5" href="sys__usb_8c.html#a147a398f76677cac67a63d26e487e631" title="Transmit a byte vis USB." alt="" coords="200,56,403,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_a44b75cba45b6c944312deccd963ba033_icgraph.png" border="0" usemap="#sys__usb_8h_a44b75cba45b6c944312deccd963ba033_icgraph" alt=""/></div>
<map name="sys__usb_8h_a44b75cba45b6c944312deccd963ba033_icgraph" id="sys__usb_8h_a44b75cba45b6c944312deccd963ba033_icgraph">
<area shape="rect" id="node3" href="app__usb_8h.html#afd3e69fbaca3347223f9a409ae53b4f6" title="Processing USB frame." alt="" coords="201,5,421,32"/><area shape="rect" id="node5" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="main" alt="" coords="469,5,520,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a147a398f76677cac67a63d26e487e631"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SYS_USB_TransmitSingleByte </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ucData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit a byte vis USB. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ucData</td><td>- data to be transmitted </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sys__usb_8c_source.html#l00123">123</a> of file <a class="el" href="sys__usb_8c_source.html">sys_usb.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="comment">//USCI_A1 TX buffer ready?</span></div>
<div class="line">    <span class="keywordflow">while</span> (!(UCA1IFG&amp;UCTXIFG));     <span class="comment">// USCI_A1 TX buffer ready?</span></div>
<div class="line">    UCA1TXBUF = ucData;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sys__usb_8h_a147a398f76677cac67a63d26e487e631_icgraph.png" border="0" usemap="#sys__usb_8h_a147a398f76677cac67a63d26e487e631_icgraph" alt=""/></div>
<map name="sys__usb_8h_a147a398f76677cac67a63d26e487e631_icgraph" id="sys__usb_8h_a147a398f76677cac67a63d26e487e631_icgraph">
<area shape="rect" id="node3" href="sys__usb_8h.html#a44b75cba45b6c944312deccd963ba033" title="Sending USB frame ACK." alt="" coords="256,5,403,32"/><area shape="rect" id="node5" href="app__usb_8h.html#afd3e69fbaca3347223f9a409ae53b4f6" title="Processing USB frame." alt="" coords="451,5,671,32"/><area shape="rect" id="node7" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="main" alt="" coords="720,5,771,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a408b6d3a4a484720bc3ecfeac8947e3.html">sys</a></li><li class="navelem"><a class="el" href="sys__usb_8h.html">sys_usb.h</a></li>
    <li class="footer">Generated on Sun May 26 2013 18:30:48 for CLEON by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
